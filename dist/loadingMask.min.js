angular.module("salsaNgLoadingMask",[]).factory("SalsaLoadingMaskScope",function(a){var s=a.$new();return s.CUSTOM_GROUP_PREFIX="customGroup",s.DEFAULT_GROUP_NAME="default",s}).factory("SalsaLoadingMaskHttpInterceptor",function(a,s){var n=function(a){if(angular.isString(a.loadingMask)){var n=/^[a-z0-9]+$/i;if(!n.test(a.loadingMask))throw new Error("Loading mask group name must contain only alphanumeric characters");return s.CUSTOM_GROUP_PREFIX+a.loadingMask}return s.DEFAULT_GROUP_NAME},t=function(a,s){return a[s]||(a[s]={hidingMaskShowed:!1,started:0,finished:0}),a[s]},e=function(e,o){if(e.config.loadingMask){var r=n(e.config),i=t(a,r);i.finished++,i.started===i.finished&&(s.$broadcast(o?"salsa:hideLoadingMask:"+r:"salsa:errorHideLoadingMask:"+r),i.hidingMaskShowed=!1,i.started=0,i.finished=0)}return e};return{request:function(e){if(e.loadingMask){var o=n(e),r=t(a,o);r.hidingMaskShowed||s.$broadcast("salsa:showLoadingMask:"+o),r.started++}return e},responseError:function(a){return e(a,!1)},response:function(a){return e(a,!0)}}}).directive("salsaLoadingMask",function(a,s,n){return{restrict:"A",template:'<div class="salsa-mask">'+s.template+"</div><ng-transclude></ng-transclude>",transclude:!0,scope:{group:"@salsaLoadingMaskGroup",fullScreenMask:"@salsaLoadingMaskFullscreen",templateData:"&salsaLoadingMaskTemplateData"},link:function(a,s){var t=a.group?n.CUSTOM_GROUP_PREFIX+a.group:n.DEFAULT_GROUP_NAME,e=s.find(".salsa-mask");a.context=a.templateData(),n.$on("salsa:showLoadingMask:"+t,function(){void 0!==a.fullScreenMask?(e.css("position","fixed"),e.css("left",0),e.css("top",0),e.css("right",0),e.css("bottom",0),e.css("z-index",999)):(e.css("position","absolute"),e.css("width",s.width()+"px"),e.css("height",s.height()+"px"),e.css("z-index",998)),e.removeClass("error"),e.addClass("shown")}),n.$on("salsa:hideLoadingMask:"+t,function(){e.removeClass("shown")}),n.$on("salsa:errorHideLoadingMask:"+t,function(){e.addClass("error"),e.removeClass("shown")})}}}).provider("SalsaLoadingMaskConfig",function(){var a={template:""};return{set:function(s){angular.extend(a,s)},$get:function(){return a}}}).config(function(a){a.interceptors.push("SalsaLoadingMaskHttpInterceptor")});